---
layout: post
title: "Word自动编号解决方案：引文、图表、公式"
date: 2015-04-26
categories: [articles, software]
tags: [Word, 编号, 引用]
comments: true
---

我觉得LaTeX比起word最方便的地方就在于它对各种编号的自动处理，例如图表、章节、公式、引用文献什么的，而且直接用一个label就可以引用。而word的优势在于其所见即所得的直观，并且可以容易地插入各种内容，如图片、表格等。但word的自动编号功能就比较让人头疼了，希望微软以后能将LaTeX的方法引入到word中。不过在此之前，只好用word提供的交叉引用功能了，现总结如下：


**参考文献**

参考文献的自动编号很容易，建一个编号列表就可以。引用的时候，打开“引用”选项卡里的“交叉引用”对话框，“引用类型”选“编号项”，“引用内容”选“段落编号”，然后选中要插入的参考文献条目，点“插入”就可以了。

至于参考文献本身的格式化，我是先用谷歌学术搜索到文献后“导入Endnote”，然后从Endnote里选好Output Style，从Preview窗口里直接复制。

<!-- more -->

<img src="\images\posts\2015-04-25_Endnote.jpg"/>

当然你也可以用Endnote插件的引用插入功能，可以直接插入格式化好的文献，不过缺点就是比较慢，不推荐。


**图片和表格**

图表的自动编号要用到“引用”选项卡里的“插入题注”功能。从对话框里选好“标签”（是图还是表），如果没有适合的还可以“新建标签”，然后点确定就可以。要在文章中引用的时候，也是在“交叉引用”对话框里，“引用类型”选图或表，“引用内容”选“只有标签和编号”。

**公式**

最复杂的就是公式的编号。方法其实和图表类似，不过如果你用图表的方法插入题注之后交叉引用，就会发现一引用就把整个公式都插入进来了。我用的方法是参考了[这个网页](http://www.fmddlmyy.cn/text58.html)，引用如下：

> 1. 在公式后tab到一个适合插入公式编号的位置后回车。
> 2. 在*新行*用“插入”->“引用”->“题注”插入公式编号。这时公式编号行是“题注”样式，公式行是原来的样式。
> 3. 将光标移到公式行的行尾，按下Ctrl+Alt+Enter键插入一个样式分隔符。这时公式编号行会连到公式行的末尾。看上去就是在同一行。 这时公式编号行还是“题注”样式，公式行也还是原来的样式。
> 4. 在需要引用公式的地方用“交叉引用”引用公式编号，可以选择“整项题注”引用公式编号行的所有内容。

这个网页虽然介绍的是很老版本的word的方法，不过对我的word2013依然适合。这个方法的关键在于用Ctrl+Alt+Enter键插入一个separator，之后就可以在一行内应用两个样式，所以word在交叉引用时就不会把公式本身也当成题注的一部分了。

如果还想让公式自动居中，编号右对齐怎么办呢？可以按照[《如何在 Word 2010 中给公式自动编号？》](http://www.zhihu.com/question/19689000)这篇文章中的做法，新建一个“居中公式”样式，然后设置其制表符位置。之后将公式设置成这个样式，在公式前后各按一下Tab，就可以对齐了。不过这个网页里面没提到separator。想交叉引用必须加separator，否则就会把公式本身一起引进去。

其他一些注意事项：

* 这样自动编号和引用的好处在于，当你想更新引用的编号数字的时候，**全选，右键“更新域”**就可以了，不用手工一个一个的去改，很方便。
* “交叉引用”这个对话框是**非模态**的，可以打开后就放在边上（其实最好设计成可停靠的选项卡）。
* 就像Ctrl+Alt+Enter一样，word里有一些在界面上找不到的功能，例如**Ctrl+Enter是换行但不分段，Shift+F5是跳到上一个视图**，等等。有些很有用，但找不到，大概是word本身做的太复杂了吧。从“选项”-“自定义功能区”-“键盘快捷方式：自定义”里可以查看并修改。
* 如果拿别人的模板来修改，可能会遇到莫名其妙的错误，此时可以**新建一个文档，自己去创建那些样式**，一般就没事了。
